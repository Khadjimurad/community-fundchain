<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title data-i18n="contract_interface.page_title">FundChain ‚Äî Contract Interface</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root { --primary-color: #2563eb; --secondary-color: #f1f5f9; --success-color: #059669; --warning-color: #d97706; --danger-color: #dc2626; --border-color: #e5e7eb; --text-primary: #1f2937; --text-secondary: #6b7280; --bg-primary: #ffffff; --bg-secondary: #f8fafc; }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; font-size: 16px; line-height: 1.7; color: var(--text-primary); background-color: var(--bg-secondary); }
    .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    .header { background: var(--bg-primary); border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 100; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .header-top { border-bottom: 1px solid var(--border-color); padding: 0.75rem 0; }
    .header-top-content { display: flex; justify-content: space-between; align-items: center; }
    .header-nav { padding: 0.75rem 0; }
    .controls-container { display: flex; align-items: center; gap: 0.5rem; }
    .logo { font-size: 1.75rem; font-weight: bold; color: var(--primary-color); }
    .nav { display: flex; gap: 2rem; }
    .nav a { text-decoration: none; color: var(--text-secondary); font-weight: 500; font-size: 1.05rem; transition: color 0.2s; }
    .nav a:hover, .nav a.active { color: var(--primary-color); }
    .status-bar { background: var(--bg-primary); border-bottom: 1px solid var(--border-color); padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-secondary); }
    .status-content { display: flex; justify-content: space-between; align-items: center; }
    .main { padding: 2rem 0; }
    .card { background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 0.75rem; padding: 1.5rem; margin-bottom: 2rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
    .card-title { font-size: 1.4rem; font-weight: 600; margin: 0; }
    .card-actions { display: flex; gap: 0.5rem; }
    .btn { display: inline-block; padding: 0.6rem 1.2rem; border: none; border-radius: 0.375rem; font-size: 0.95rem; font-weight: 500; text-decoration: none; cursor: pointer; transition: all 0.2s; }
    .btn-primary { background: var(--primary-color); color: white; }
    .btn-secondary { background: var(--secondary-color); color: var(--text-primary); border: 1px solid var(--border-color); }
    .btn-warning { background: #f59e0b; color: white; border: 1px solid #f59e0b; }
    .btn-info { background: #3b82f6; color: white; border: 1px solid #3b82f6; }
    .btn-success { background: var(--success-color); color: white; border: 1px solid var(--success-color); }
    .badge { display: inline-block; padding: 0.3rem 0.6rem; border-radius: 0.25rem; font-size: 0.8rem; font-weight: 500; }
    .badge-success { background: #dcfce7; color: var(--success-color); }
    .badge-warning { background: #fef3c7; color: var(--warning-color); }
    .badge-danger { background: #fee2e2; color: var(--danger-color); }
    .badge-info { background: #dbeafe; color: var(--primary-color); }
    .data-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    .data-table th, .data-table td { padding: 0.8rem; text-align: left; border-bottom: 1px solid var(--border-color); font-size: 0.95rem; }
    .text-muted { color: var(--text-secondary); }
    .hidden { display: none; }
    .form-group { margin-bottom: 1rem; }
    .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
    .form-control { width: 100%; padding: 0.6rem 0.8rem; border: 1px solid var(--border-color); border-radius: 0.375rem; font-size: 1rem; transition: border-color 0.2s; }
    .form-control:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2); }
    .form-row { display: flex; gap: 1rem; margin-bottom: 1rem; }
    .form-row .form-group { flex: 1; }
    .contract-section { margin-bottom: 2rem; }
    .contract-header { padding: 1rem; background: var(--secondary-color); border-radius: 0.375rem; margin-bottom: 1rem; }
    .contract-body { padding: 1rem; background: white; border: 1px solid var(--border-color); border-radius: 0.375rem; }
    .code-block { font-family: monospace; background: #f8f9fa; padding: 1rem; border-radius: 0.375rem; overflow-x: auto; white-space: pre; margin: 1rem 0; }
    .alert { padding: 1rem; border-radius: 0.375rem; margin-bottom: 1rem; }
    .alert-info { background: #dbeafe; border-left: 4px solid #3b82f6; }
    .alert-warning { background: #fef3c7; border-left: 4px solid #f59e0b; }
    .alert-success { background: #dcfce7; border-left: 4px solid var(--success-color); }
    .alert-danger { background: #fee2e2; border-left: 4px solid var(--danger-color); }
    .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; display: flex; align-items: center; justify-content: center; }
    .modal.hidden { display: none; }
    .modal-backdrop { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
    .modal-content { background: white; border-radius: 0.5rem; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); max-width: 90vw; max-height: 90vh; overflow: auto; position: relative; z-index: 1001; min-width: 400px; }
    .modal-header { padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-color); display: flex; justify-content: between; align-items: center; }
    .modal-title { margin: 0; font-size: 1.35rem; font-weight: 600; }
    .modal-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-secondary); margin-left: auto; }
    .modal-body { padding: 1.5rem; }
    .modal-footer { padding: 1rem 1.5rem; border-top: 1px solid var(--border-color); display: flex; gap: 1rem; justify-content: flex-end; }
    .tab-container { margin-top: 1rem; }
    .tab-header { display: flex; border-bottom: 1px solid var(--border-color); }
    .tab-item { padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 500; }
    .tab-item.active { border-bottom: 2px solid var(--primary-color); color: var(--primary-color); }
    .tab-content { padding: 1.5rem 0; }
    .tab-pane { display: none; }
    .tab-pane.active { display: block; }
    .section-title { font-size: 1.2rem; font-weight: 600; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); }
    .transaction-list { margin: 1rem 0; }
    .transaction-item { padding: 1rem; border: 1px solid var(--border-color); border-radius: 0.375rem; margin-bottom: 0.5rem; }
    .transaction-header { display: flex; justify-content: space-between; margin-bottom: 0.5rem; }
    .transaction-id { font-weight: 600; }
    .transaction-actions { display: flex; gap: 0.5rem; }
    .transaction-details { font-size: 0.9rem; color: var(--text-secondary); }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-top">
      <div class="container">
        <div class="header-top-content">
          <div class="logo">üèõÔ∏è FundChain</div>
          <div class="controls-container">
            <button id="language-switcher" class="btn btn-secondary" onclick="window.i18n.toggleLanguage()" title="Switch Language" data-i18n="language.switch_to_english" data-i18n-title="language.switch_to_english">üá∫üá∏ EN</button>
            <a href="./index.html" class="btn btn-secondary" title="Back to main" data-i18n="buttons.back" data-i18n-title="buttons.back">‚Üê Main</a>
          </div>
        </div>
      </div>
    </div>
    <div class="header-nav">
      <div class="container">
        <nav class="nav">
          <a href="./index.html" data-i18n="navigation.dashboard">Dashboard</a>
          <a href="./index.html" data-i18n="navigation.dashboard">Dashboard</a>
          <a href="./index.html" data-i18n="navigation.projects">Projects</a>
          <a href="./index.html" data-i18n="navigation.voting">Voting</a>
          <a href="./index.html" data-i18n="navigation.treasury">Treasury</a>
          <a href="./index.html" data-i18n="navigation.personal">My Stats</a>
          <a href="./admin.html" data-i18n="navigation.admin">Admin</a>
          <a href="#" class="active" data-i18n="navigation.contract_interface">Contract Interface</a>
          <a href="./project-payout.html" data-i18n="navigation.project_payout">Project Payout</a>
        </nav>
      </div>
    </div>
  </header>

  <div class="status-bar">
    <div class="container">
      <div class="status-content">
        <div data-i18n="contract_interface.status">Status: <span id="connection-status" data-i18n="contract_interface.status_disconnected">Disconnected</span></div>
        <div id="account-info" class="hidden" data-i18n="contract_interface.account">Account: <span id="current-account" data-i18n="contract_interface.not_connected">Not connected</span></div>
      </div>
    </div>
  </div>

  <main class="main">
    <div class="container">
      <h1 data-i18n="contract_interface.title">Smart Contract Interface</h1>
      <p class="text-muted" data-i18n="contract_interface.info_connect_web3">Direct interaction with FundChain smart contracts through Web3</p>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title" data-i18n="contract_interface.connection_settings">Connection Settings</h2>
        </div>
        <div class="card-body">
          <div class="alert alert-info">
            <strong data-i18n="contract_interface.info">Info:</strong> <span data-i18n="contract_interface.info_connect_web3">Connect to Web3 provider to interact with the smart contracts.</span>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="rpc-url" data-i18n="contract_interface.rpc_url">RPC URL</label>
              <input type="text" id="rpc-url" class="form-control" value="http://localhost:8545">
            </div>
            <div class="form-group">
              <label for="chain-id" data-i18n="contract_interface.chain_id">Chain ID</label>
              <input type="number" id="chain-id" class="form-control" value="31337">
            </div>
          </div>
          
          <div class="form-group">
            <label for="private-key" data-i18n="contract_interface.private_key">Private Key (optional)</label>
            <input type="password" id="private-key" class="form-control" placeholder="Enter private key for signing transactions" data-i18n-placeholder="contract_interface.private_key_placeholder">
            <small class="text-muted" data-i18n="contract_interface.private_key_help">If not provided, will try to use browser wallet (MetaMask)</small>
          </div>
          
          <div class="form-group">
            <button id="connect-button" class="btn btn-primary" data-i18n="contract_interface.connect_web3">Connect to Web3</button>
            <button id="disconnect-button" class="btn btn-secondary hidden" data-i18n="contract_interface.disconnect">Disconnect</button>
          </div>
        </div>
      </div>

      <div id="contracts-interface" class="hidden">
        <div class="tab-container">
          <div class="tab-header">
            <div class="tab-item active" data-tab="multisig" data-i18n="contract_interface.community_multisig">CommunityMultisig</div>
            <div class="tab-item" data-tab="treasury" data-i18n="contract_interface.treasury">Treasury</div>
            <div class="tab-item" data-tab="projects" data-i18n="contract_interface.projects">Projects</div>
            <div class="tab-item" data-tab="governance" data-i18n="contract_interface.governance_sbt">GovernanceSBT</div>
            <div class="tab-item" data-tab="ballot" data-i18n="contract_interface.ballot_commit_reveal">BallotCommitReveal</div>
          </div>
          
          <div class="tab-content">
            <!-- CommunityMultisig Tab -->
            <div id="multisig-tab" class="tab-pane active">
              <div class="contract-section">
                <h3 class="section-title" data-i18n="contract_interface.community_multisig">CommunityMultisig Contract</h3>
                <div class="form-group">
                  <label for="multisig-address" data-i18n="contract_interface.contract_address">Contract Address</label>
                  <input type="text" id="multisig-address" class="form-control" value="0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65">
                </div>
                
                <div class="contract-header">
                  <h4 data-i18n="contract_interface.transaction_management">Transaction Management</h4>
                </div>
                
                <div class="contract-body">
                  <div class="tab-container">
                    <div class="tab-header">
                      <div class="tab-item active" data-tab="propose" data-i18n="contract_interface.propose_transaction">Propose Transaction</div>
                      <div class="tab-item" data-tab="confirm" data-i18n="contract_interface.confirm_transaction">Confirm Transaction</div>
                      <div class="tab-item" data-tab="execute" data-i18n="contract_interface.execute_transaction">Execute Transaction</div>
                      <div class="tab-item" data-tab="transactions" data-i18n="contract_interface.view_transactions">View Transactions</div>
                    </div>
                    
                    <div class="tab-content">
                      <!-- Propose Transaction Tab -->
                      <div id="propose-tab" class="tab-pane active">
                        <h5 data-i18n="contract_interface.propose_payout">Propose Project Payout</h5>
                        <div class="form-group">
                          <label for="recipient-address" data-i18n="contract_interface.recipient_address">Recipient Address</label>
                          <input type="text" id="recipient-address" class="form-control" placeholder="0x..." data-i18n-placeholder="contract_interface.recipient_address_placeholder">
                        </div>
                        <div class="form-group">
                          <label for="project-id" data-i18n="contract_interface.project_id">Project ID</label>
                          <input type="text" id="project-id" class="form-control" placeholder="0x..." data-i18n-placeholder="contract_interface.project_id_placeholder">
                        </div>
                        <div class="form-group">
                          <label for="payout-amount" data-i18n="contract_interface.amount_eth">Amount (ETH)</label>
                          <input type="number" id="payout-amount" class="form-control" step="0.01" min="0.01">
                        </div>
                        <div class="form-group">
                          <label for="payout-description" data-i18n="contract_interface.description">Description</label>
                          <textarea id="payout-description" class="form-control" rows="3" placeholder="Describe the purpose of this payout" data-i18n-placeholder="contract_interface.description_placeholder"></textarea>
                        </div>
                        <button id="propose-button" class="btn btn-primary" data-i18n="contract_interface.propose_payout_button">Propose Payout</button>
                      </div>
                      
                      <!-- Confirm Transaction Tab -->
                      <div id="confirm-tab" class="tab-pane">
                        <h5 data-i18n="contract_interface.confirm_transaction">Confirm Transaction</h5>
                        <div class="form-group">
                          <label for="confirm-tx-id" data-i18n="contract_interface.transaction_id">Transaction ID</label>
                          <input type="number" id="confirm-tx-id" class="form-control" min="1">
                        </div>
                        <button id="confirm-button" class="btn btn-primary" data-i18n="contract_interface.confirm_transaction_button">Confirm Transaction</button>
                        <hr>
                        <h5 data-i18n="contract_interface.view_tx_details">View Transaction Details</h5>
                        <div class="form-group">
                          <label for="view-tx-id" data-i18n="contract_interface.transaction_id">Transaction ID</label>
                          <input type="number" id="view-tx-id" class="form-control" min="1">
                        </div>
                        <button id="view-tx-button" class="btn btn-secondary" data-i18n="contract_interface.view_details">View Details</button>
                        <div id="tx-details" class="code-block hidden"></div>
                      </div>
                      
                      <!-- Execute Transaction Tab -->
                      <div id="execute-tab" class="tab-pane">
                        <h5 data-i18n="contract_interface.execute_transaction">Execute Transaction</h5>
                        <div class="form-group">
                          <label for="execute-tx-id" data-i18n="contract_interface.transaction_id">Transaction ID</label>
                          <input type="number" id="execute-tx-id" class="form-control" min="1">
                        </div>
                        <button id="execute-button" class="btn btn-warning" data-i18n="contract_interface.execute_transaction_button">Execute Transaction</button>
                      </div>
                      
                      <!-- View Transactions Tab -->
                      <div id="transactions-tab" class="tab-pane">
                        <h5 data-i18n="contract_interface.recent_transactions">Recent Transactions</h5>
                        <button id="refresh-txs-button" class="btn btn-secondary" data-i18n="contract_interface.refresh_list">Refresh List</button>
                        <div id="transaction-list" class="transaction-list">
                          <div class="alert alert-info" data-i18n="contract_interface.info_connect_web3">Connect to view transactions</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Treasury Tab -->
            <div id="treasury-tab" class="tab-pane">
              <div class="contract-section">
                <h3 class="section-title" data-i18n="contract_interface.treasury">Treasury Contract</h3>
                <div class="form-group">
                  <label for="treasury-address" data-i18n="contract_interface.contract_address">Contract Address</label>
                  <input type="text" id="treasury-address" class="form-control" value="0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266">
                </div>
                
                <div class="contract-header">
                  <h4 data-i18n="contract_interface.treasury_info">Treasury Information</h4>
                </div>
                
                <div class="contract-body">
                  <div class="form-group">
                    <button id="get-treasury-info" class="btn btn-secondary" data-i18n="contract_interface.get_treasury_info">Get Treasury Info</button>
                  </div>
                  
                  <div id="treasury-info" class="code-block hidden"></div>
                </div>

                <div class="contract-header mt-4">
                  <h4 data-i18n="contract_interface.project_allocation">Project Allocation</h4>
                </div>
                
                <div class="contract-body">
                  <div class="form-group">
                    <label for="allocation-project-id" data-i18n="contract_interface.project_id">Project ID</label>
                    <input type="text" id="allocation-project-id" class="form-control" placeholder="0x..." data-i18n-placeholder="contract_interface.project_id_placeholder">
                  </div>
                  
                  <div class="form-group">
                    <button id="get-allocation-info" class="btn btn-secondary" data-i18n="contract_interface.get_allocation_info">Get Allocation Info</button>
                  </div>
                  
                  <div id="allocation-info" class="code-block hidden"></div>
                </div>
              </div>
            </div>
            
            <!-- Projects Tab -->
            <div id="projects-tab" class="tab-pane">
              <div class="contract-section">
                <h3 class="section-title" data-i18n="contract_interface.projects">Projects Contract</h3>
                <div class="form-group">
                  <label for="projects-address" data-i18n="contract_interface.contract_address">Contract Address</label>
                  <input type="text" id="projects-address" class="form-control" value="0x70997970C51812dc3A010C7d01b50e0d17dc79C8">
                </div>
                
                <div class="contract-header">
                  <h4 data-i18n="contract_interface.project_status">Project Status</h4>
                </div>
                
                <div class="contract-body">
                  <div class="form-group">
                    <label for="project-status-id" data-i18n="contract_interface.project_id">Project ID</label>
                    <input type="text" id="project-status-id" class="form-control" placeholder="0x..." data-i18n-placeholder="contract_interface.project_id_placeholder">
                  </div>
                  
                  <div class="form-group">
                    <button id="get-project-info" class="btn btn-secondary" data-i18n="contract_interface.get_project_info">Get Project Info</button>
                  </div>
                  
                  <div id="project-info" class="code-block hidden"></div>
                  
                  <hr>
                  
                  <h5 data-i18n="contract_interface.update_project_status">Update Project Status</h5>
                  <div class="form-group">
                    <label for="update-project-id" data-i18n="contract_interface.project_id">Project ID</label>
                    <input type="text" id="update-project-id" class="form-control" placeholder="0x..." data-i18n-placeholder="contract_interface.project_id_placeholder">
                  </div>
                  
                  <div class="form-group">
                    <label for="new-status" data-i18n="contract_interface.new_status">New Status</label>
                    <select id="new-status" class="form-control">
                      <option value="0" data-i18n="contract_interface.draft">Draft</option>
                      <option value="1" data-i18n="contract_interface.active">Active</option>
                      <option value="2" data-i18n="contract_interface.funding_ready">FundingReady</option>
                      <option value="3" data-i18n="contract_interface.voting">Voting</option>
                      <option value="4" data-i18n="contract_interface.ready_to_payout">ReadyToPayout</option>
                      <option value="5" data-i18n="contract_interface.paid">Paid</option>
                      <option value="6" data-i18n="contract_interface.cancelled">Cancelled</option>
                      <option value="7" data-i18n="contract_interface.archived">Archived</option>
                    </select>
                  </div>
                  
                  <div class="form-group">
                    <label for="status-reason" data-i18n="contract_interface.status_reason">Reason</label>
                    <input type="text" id="status-reason" class="form-control" placeholder="Reason for status change" data-i18n-placeholder="contract_interface.status_reason_placeholder">
                  </div>
                  
                  <button id="update-status-button" class="btn btn-warning" data-i18n="contract_interface.update_status_button">Update Status</button>
                </div>
              </div>
            </div>
            
            <!-- GovernanceSBT Tab -->
            <div id="governance-tab" class="tab-pane">
              <div class="contract-section">
                <h3 class="section-title" data-i18n="contract_interface.governance_sbt">GovernanceSBT Contract</h3>
                <div class="form-group">
                  <label for="governance-address" data-i18n="contract_interface.contract_address">Contract Address</label>
                  <input type="text" id="governance-address" class="form-control" value="0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC">
                </div>
                
                <div class="contract-header">
                  <h4 data-i18n="contract_interface.sbt_info">SBT Information</h4>
                </div>
                
                <div class="contract-body">
                  <div class="form-group">
                    <label for="sbt-address" data-i18n="contract_interface.sbt_address">Address</label>
                    <input type="text" id="sbt-address" class="form-control" placeholder="0x..." data-i18n-placeholder="contract_interface.sbt_address_placeholder">
                  </div>
                  
                  <div class="form-group">
                    <button id="get-sbt-info" class="btn btn-secondary" data-i18n="contract_interface.get_sbt_info">Get SBT Info</button>
                  </div>
                  
                  <div id="sbt-info" class="code-block hidden"></div>
                </div>
              </div>
            </div>
            
            <!-- BallotCommitReveal Tab -->
            <div id="ballot-tab" class="tab-pane">
              <div class="contract-section">
                <h3 class="section-title" data-i18n="contract_interface.ballot_commit_reveal">BallotCommitReveal Contract</h3>
                <div class="form-group">
                  <label for="ballot-address" data-i18n="contract_interface.contract_address">Contract Address</label>
                  <input type="text" id="ballot-address" class="form-control" value="0x90F79bf6EB2c4f870365E785982E1f101E93b906">
                </div>
                
                <div class="contract-header">
                  <h4 data-i18n="contract_interface.voting_round">Current Voting Round</h4>
                </div>
                
                <div class="contract-body">
                  <div class="form-group">
                    <button id="get-voting-info" class="btn btn-secondary" data-i18n="contract_interface.get_voting_info">Get Current Round Info</button>
                  </div>
                  
                  <div id="voting-info" class="code-block hidden"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <div id="modal" class="modal hidden">
    <div class="modal-backdrop" onclick="contractInterface.closeModal()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modal-title" data-i18n="modal.title">Modal Title</h3>
        <button class="modal-close" onclick="contractInterface.closeModal()">&times;</button>
      </div>
      <div class="modal-body" id="modal-body"></div>
      <div class="modal-footer" id="modal-footer">
        <button class="btn btn-secondary" onclick="contractInterface.closeModal()" data-i18n="buttons.close">Close</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
  <script src="./js/i18n.js"></script>
  <script src="./contract-interface.js"></script>
</body>
</html>