<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title data-i18n="project_payout.page_title">FundChain ‚Äî –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—ã–ø–ª–∞—Ç –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root { --primary-color: #2563eb; --secondary-color: #f1f5f9; --success-color: #059669; --warning-color: #d97706; --danger-color: #dc2626; --border-color: #e5e7eb; --text-primary: #1f2937; --text-secondary: #6b7280; --bg-primary: #ffffff; --bg-secondary: #f8fafc; }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; font-size: 16px; line-height: 1.7; color: var(--text-primary); background-color: var(--bg-secondary); }
    .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    .header { background: var(--bg-primary); border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 100; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .header-top { border-bottom: 1px solid var(--border-color); padding: 0.75rem 0; }
    .header-top-content { display: flex; justify-content: space-between; align-items: center; }
    .header-nav { padding: 0.75rem 0; }
    .controls-container { display: flex; align-items: center; gap: 0.5rem; }
    .logo { font-size: 1.75rem; font-weight: bold; color: var(--primary-color); }
    .nav { display: flex; gap: 2rem; }
    .nav a { text-decoration: none; color: var(--text-secondary); font-weight: 500; font-size: 1.05rem; transition: color 0.2s; }
    .nav a:hover, .nav a.active { color: var(--primary-color); }
    .status-bar { background: var(--bg-primary); border-bottom: 1px solid var(--border-color); padding: 0.5rem 0; font-size: 0.95rem; color: var(--text-secondary); }
    .status-content { display: flex; justify-content: space-between; align-items: center; }
    .main { padding: 2rem 0; }
    .card { background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 0.75rem; padding: 1.5rem; margin-bottom: 2rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
    .card-title { font-size: 1.4rem; font-weight: 600; margin: 0; }
    .card-actions { display: flex; gap: 0.5rem; }
    .btn { display: inline-block; padding: 0.6rem 1.2rem; border: none; border-radius: 0.375rem; font-size: 0.95rem; font-weight: 500; text-decoration: none; cursor: pointer; transition: all 0.2s; }
    .btn-primary { background: var(--primary-color); color: white; }
    .btn-secondary { background: var(--secondary-color); color: var(--text-primary); border: 1px solid var(--border-color); }
    .btn-warning { background: #f59e0b; color: white; border: 1px solid #f59e0b; }
    .btn-info { background: #3b82f6; color: white; border: 1px solid #3b82f6; }
    .btn-success { background: var(--success-color); color: white; border: 1px solid var(--success-color); }
    .btn-xs { padding: 0.3rem 0.6rem; font-size: 0.8rem; }
    .badge { display: inline-block; padding: 0.3rem 0.6rem; border-radius: 0.25rem; font-size: 0.8rem; font-weight: 500; }
    .badge-success { background: #dcfce7; color: var(--success-color); }
    .badge-warning { background: #fef3c7; color: var(--warning-color); }
    .badge-danger { background: #fee2e2; color: var(--danger-color); }
    .badge-info { background: #dbeafe; color: var(--primary-color); }
    .data-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    .data-table th, .data-table td { padding: 0.8rem; text-align: left; border-bottom: 1px solid var(--border-color); font-size: 0.95rem; }
    .text-muted { color: var(--text-secondary); }
    .hidden { display: none; }
    .form-group { margin-bottom: 1rem; }
    .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
    .form-control { width: 100%; padding: 0.6rem 0.8rem; border: 1px solid var(--border-color); border-radius: 0.375rem; font-size: 1rem; transition: border-color 0.2s; }
    .form-control:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2); }
    .form-row { display: flex; gap: 1rem; margin-bottom: 1rem; }
    .form-row .form-group { flex: 1; }
    .alert { padding: 1rem; border-radius: 0.375rem; margin-bottom: 1rem; }
    .alert-info { background: #dbeafe; border-left: 4px solid #3b82f6; }
    .alert-warning { background: #fef3c7; border-left: 4px solid #f59e0b; }
    .alert-success { background: #dcfce7; border-left: 4px solid var(--success-color); }
    .alert-danger { background: #fee2e2; border-left: 4px solid var(--danger-color); }

    .payout-workflow { display: flex; margin-bottom: 2rem; }
    .workflow-step { flex: 1; padding: 1rem; text-align: center; border: 1px solid var(--border-color); border-radius: 0.5rem; margin: 0 0.5rem; background: var(--bg-primary); position: relative; }
    .workflow-step.active { border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2); }
    .workflow-step.completed { border-color: var(--success-color); background: #f0fdf4; }
    .step-number { display: inline-block; width: 2rem; height: 2rem; background: var(--secondary-color); border-radius: 50%; line-height: 2rem; font-weight: bold; margin-bottom: 0.5rem; }
    .workflow-step.active .step-number { background: var(--primary-color); color: white; }
    .workflow-step.completed .step-number { background: var(--success-color); color: white; }
    .step-title { font-weight: 600; margin-bottom: 0.5rem; }
    .step-description { font-size: 0.9rem; color: var(--text-secondary); }
    .project-card { border: 1px solid var(--border-color); border-radius: 0.75rem; padding: 1.5rem; margin-bottom: 1.5rem; transition: all 0.2s; background: var(--bg-primary); }
    .project-card:hover { box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.1); transform: translateY(-2px); }
    .project-card.selected { border-color: var(--primary-color); background: #f0f7ff; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
    .project-header { display: flex; justify-content: space-between; margin-bottom: 0.5rem; }
    .project-title { font-weight: 600; }
    .project-status { }
    .project-details { font-size: 0.9rem; }
    .project-metrics { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem; }
    .project-metric { font-size: 0.9rem; color: var(--text-secondary); padding: 0.5rem; background: var(--bg-secondary); border-radius: 0.375rem; }
    .project-description { margin-bottom: 1rem; line-height: 1.5; }
    .project-actions { margin-top: 1rem; text-align: right; }
    .text-success { color: var(--success-color); }
    .mt-3 { margin-top: 1rem; }
    .transaction-list { margin: 1rem 0; }
    .transaction-item { padding: 1rem; border: 1px solid var(--border-color); border-radius: 0.375rem; margin-bottom: 0.5rem; }
    .transaction-header { display: flex; justify-content: space-between; margin-bottom: 0.5rem; }
    .transaction-id { font-weight: 600; }
    .transaction-actions { display: flex; gap: 0.5rem; }
    .transaction-details { font-size: 0.9rem; color: var(--text-secondary); }
    .step-content { padding: 1.5rem 0; }
    
    /* Modal styles */
    .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; display: flex; align-items: center; justify-content: center; }
    .modal.hidden { display: none; }
    .modal-backdrop { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); }
    .modal-content { position: relative; background: var(--bg-primary); border-radius: 0.75rem; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); width: 95%; max-width: 800px; max-height: 85vh; overflow-y: auto; }
    .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem 0.75rem; border-bottom: 1px solid var(--border-color); }
    .modal-title { margin: 0; font-size: 1.1rem; font-weight: 600; }
    .modal-close { background: none; border: none; font-size: 1.25rem; cursor: pointer; color: var(--text-secondary); padding: 0; width: 1.75rem; height: 1.75rem; display: flex; align-items: center; justify-content: center; border-radius: 0.375rem; transition: all 0.2s; }
    .modal-close:hover { background: var(--bg-secondary); color: var(--text-primary); }
    .modal-body { padding: 1rem 1.5rem; }
    .modal-footer { padding: 0.75rem 1.5rem; border-top: 1px solid var(--border-color); display: flex; justify-content: flex-end; gap: 0.5rem; }
    
    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
    .modal-body code { background: var(--bg-secondary); padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-family: monospace; font-size: 0.85rem; }
    .modal-body ul { margin: 0.75rem 0; padding-left: 1.25rem; }
    .modal-body li { margin-bottom: 0.25rem; }
    .modal-body h4 { margin: 0.75rem 0 0.5rem; font-size: 1rem; }
    .modal-body p { margin: 0.5rem 0; }
    .modal-body .alert { padding: 0.75rem; margin-bottom: 0.75rem; }
    .modal-body .data-table { margin-top: 0.5rem; }
    .modal-body .data-table table { width: 100%; border-collapse: collapse; }
    .modal-body .data-table td { padding: 0.4rem 0.6rem; border-bottom: 1px solid var(--border-color); font-size: 0.9rem; }
    .modal-body .data-table td:first-child { font-weight: 500; width: 40%; }
    .modal-body .data-table td:last-child { width: 60%; word-break: break-all; }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-top">
      <div class="container">
        <div class="header-top-content">
          <div class="logo">üèõÔ∏è FundChain</div>
          <div class="controls-container">
            <button id="language-switcher" class="btn btn-secondary" onclick="window.i18n.toggleLanguage()" title="Switch Language" data-i18n="language.switch_to_english" data-i18n-title="language.switch_to_english">üá∫üá∏ EN</button>
            <a href="./index.html" class="btn btn-secondary" title="Back to main" data-i18n="buttons.back" data-i18n-title="buttons.back">‚Üê Main</a>
          </div>
        </div>
      </div>
    </div>
    <div class="header-nav">
      <div class="container">
        <nav class="nav">
          <a href="./index.html" data-i18n="navigation.dashboard">Dashboard</a>
          <a href="./index.html" data-i18n="navigation.projects">Projects</a>
          <a href="./index.html" data-i18n="navigation.voting">Voting</a>
          <a href="./index.html" data-i18n="navigation.treasury">Treasury</a>
          <a href="./index.html" data-i18n="navigation.personal">My Stats</a>
          <a href="./admin.html" data-i18n="navigation.admin">Admin</a>
          <a href="#" class="active" data-i18n="navigation.project_payout">Project Payout</a>
        </nav>
      </div>
    </div>
  </header>

  <div class="status-bar">
    <div class="container">
      <div class="status-content">
        <div data-i18n="project_payout.status">Status: <span id="connection-status" data-i18n="project_payout.status_disconnected">Disconnected</span></div>
        <div id="account-info" class="hidden" data-i18n="project_payout.account">Account: <span id="current-account" data-i18n="project_payout.not_connected">Not connected</span></div>
      </div>
    </div>
  </div>

  <main class="main">
    <div class="container">
      <h1 data-i18n="project_payout.title"><i class="fas fa-money-bill-wave"></i> –í—ã–ø–ª–∞—Ç—ã –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤</h1>
      <p class="text-muted" data-i18n="project_payout.info_connect_web3">–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—ã–ø–ª–∞—Ç –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤</p>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title" data-i18n="project_payout.web3_connection"><i class="fas fa-plug"></i> –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Web3</h2>
        </div>
        <div class="card-body">
          <div class="alert alert-info">
            <strong data-i18n="project_payout.info">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> <span data-i18n="project_payout.info_connect_web3">–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Web3 –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–æ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏.</span>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="rpc-url" data-i18n="project_payout.rpc_url">RPC URL</label>
              <input type="text" id="rpc-url" class="form-control" value="http://localhost:8545">
            </div>
            <div class="form-group">
              <label for="chain-id" data-i18n="project_payout.chain_id">Chain ID</label>
              <input type="number" id="chain-id" class="form-control" value="31337">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="multisig-address" data-i18n="project_payout.multisig_address">Multisig Address</label>
              <input type="text" id="multisig-address" class="form-control" value="0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65">
            </div>
            <div class="form-group">
              <label for="treasury-address" data-i18n="project_payout.treasury_address">Treasury Address</label>
              <input type="text" id="treasury-address" class="form-control" value="0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266">
            </div>
            <div class="form-group">
              <label for="projects-address" data-i18n="project_payout.projects_address">Projects Address</label>
              <input type="text" id="projects-address" class="form-control" value="0x70997970C51812dc3A010C7d01b50e0d17dc79C8">
            </div>
          </div>
          
          <div class="form-group">
            <label for="private-key" data-i18n="project_payout.private_key">Private Key (optional)</label>
            <input type="password" id="private-key" class="form-control" placeholder="Enter private key for signing transactions" data-i18n-placeholder="project_payout.private_key_placeholder">
            <small class="text-muted" data-i18n="project_payout.private_key_help">If not provided, will try to use browser wallet (MetaMask)</small>
          </div>
          
          <div class="form-group">
            <button id="connect-button" class="btn btn-primary" data-i18n="project_payout.connect_web3">
              <i class="fas fa-plug"></i> –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Web3
            </button>
            <button id="disconnect-button" class="btn btn-secondary hidden" data-i18n="project_payout.disconnect">
              <i class="fas fa-times"></i> –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è
            </button>
            <!-- Debug button -->
            <button id="debug-state" class="btn btn-info">
              <i class="fas fa-info-circle"></i> Check State
            </button>
            <button id="clear-tx-id" class="btn btn-warning">
              <i class="fas fa-eraser"></i> Clear TX ID
            </button>
            <button id="reset-workflow" class="btn btn-danger">
              <i class="fas fa-redo"></i> Reset Workflow
            </button>
          </div>
        </div>
      </div>

      <div id="payout-interface" class="hidden">
        <div class="payout-workflow">
          <div class="workflow-step active" id="step-1">
            <div class="step-number">1</div>
            <div class="step-title" data-i18n="project_payout.workflow_steps.step_1">–í—ã–±–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞</div>
            <div class="step-description" data-i18n="project_payout.step_descriptions.step_1_desc">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤—ã–π –∫ –≤—ã–ø–ª–∞—Ç–µ</div>
          </div>
          <div class="workflow-step" id="step-2">
            <div class="step-number">2</div>
            <div class="step-title" data-i18n="project_payout.workflow_steps.step_2">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤—ã–ø–ª–∞—Ç—ã</div>
            <div class="step-description" data-i18n="project_payout.step_descriptions.step_2_desc">–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤ –º—É–ª—å—Ç–∏—Å–∏–≥</div>
          </div>
          <div class="workflow-step" id="step-3">
            <div class="step-number">3</div>
            <div class="step-title" data-i18n="project_payout.workflow_steps.step_3">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
            <div class="step-description" data-i18n="project_payout.step_descriptions.step_3_desc">–°–æ–±–µ—Ä–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–¥–ø–∏—Å–∏</div>
          </div>
          <div class="workflow-step" id="step-4">
            <div class="step-number">4</div>
            <div class="step-title" data-i18n="project_payout.workflow_steps.step_4">–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ</div>
            <div class="step-description" data-i18n="project_payout.step_descriptions.step_4_desc">–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤—ã–ø–ª–∞—Ç—ã</div>
          </div>
          <div class="workflow-step" id="step-5">
            <div class="step-number">5</div>
            <div class="step-title" data-i18n="project_payout.workflow_steps.step_5">–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ</div>
            <div class="step-description" data-i18n="project_payout.step_descriptions.step_5_desc">–ó–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç</div>
          </div>
        </div>

        <!-- Step 1: Select Project -->
        <div class="card" id="step-1-content">
          <div class="card-header">
            <h2 class="card-title" data-i18n="project_payout.step_1_content.title"><i class="fas fa-list"></i> –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è –≤—ã–ø–ª–∞—Ç—ã</h2>
            <div class="card-actions">
                              <button id="refresh-projects-button" class="btn btn-secondary" data-i18n="project_payout.step_1_content.refresh_projects">
                  <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
                </button>
            </div>
          </div>
          <div class="card-body">
            <div class="alert alert-info">
              <strong data-i18n="project_payout.workflow_steps.step_1">–®–∞–≥ 1:</strong> <span data-i18n="project_payout.step_1_content.info_step_1">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –≥–æ—Ç–æ–≤ –∫ –≤—ã–ø–ª–∞—Ç–µ. –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–æ–µ–∫—Ç—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "ReadyToPayout".</span>
            </div>
            
            <div id="projects-list">
              <div class="alert alert-info">
                <h4>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è –≤—ã–ø–ª–∞—Ç—ã</h4>
                <p>–ó–¥–µ—Å—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–æ–µ–∫—Ç—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "ReadyToPayout" (–≥–æ—Ç–æ–≤—ã–µ –∫ –≤—ã–ø–ª–∞—Ç–µ).</p>
                <p>–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–µ—Ç, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–∏ –æ–¥–∏–Ω –ø—Ä–æ–µ–∫—Ç –µ—â–µ –Ω–µ –ø—Ä–æ—à–µ–ª –≤—Å–µ —ç—Ç–∞–ø—ã —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è.</p>
              </div>
            </div>
            
            <div class="form-group">
              <button id="next-step-1" class="btn btn-primary" disabled data-i18n="project_payout.step_1_content.next_step">
                <i class="fas fa-arrow-right"></i> –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É
              </button>
            </div>
          </div>
        </div>

        <!-- Step 2: Propose Payout -->
        <div class="card hidden" id="step-2-content">
          <div class="card-header">
            <h2 class="card-title" data-i18n="project_payout.step_2_content.title"><i class="fas fa-file-invoice-dollar"></i> –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É –ø–æ –ø—Ä–æ–µ–∫—Ç—É</h2>
          </div>
          <div class="card-body">
            <div class="alert alert-info">
              <strong data-i18n="project_payout.workflow_steps.step_2">Step 2:</strong> <span data-i18n="project_payout.step_2_content.info_step_2">Create a multisig proposal for project payout. This will not transfer funds yet, just create a proposal that requires signatures.</span>
            </div>
            
            <div id="selected-project-info">
              <h3 data-i18n="project_payout.step_2_content.selected_project">Selected Project: <span id="project-name-display"></span></h3>
              <div class="project-details" id="project-details-display"></div>
            </div>
            
            <div class="form-group">
              <label for="recipient-address" data-i18n="project_payout.step_2_content.recipient_address">Recipient Address</label>
              <input type="text" id="recipient-address" class="form-control" placeholder="0x..." data-i18n-placeholder="project_payout.step_2_content.recipient_address_placeholder">
            </div>
            
            <div class="form-group">
              <label for="payout-amount" data-i18n="project_payout.step_2_content.amount_eth">Amount (ETH)</label>
              <input type="number" id="payout-amount" class="form-control" step="0.01" min="0.01">
              <small class="text-muted" data-i18n="project_payout.step_2_content.max_available">Maximum available: <span id="max-available">0</span> ETH</small>
            </div>
            
            <div class="form-group">
              <label for="payout-description" data-i18n="project_payout.step_2_content.payout_description">Description</label>
              <textarea id="payout-description" class="form-control" rows="3" placeholder="Describe the purpose of this payout" data-i18n-placeholder="project_payout.step_2_content.payout_description_placeholder"></textarea>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <button id="back-step-2" class="btn btn-secondary" data-i18n="project_payout.step_2_content.back">Back</button>
              </div>
              <div class="form-group" style="text-align: right;">
                <button id="propose-button" class="btn btn-primary" data-i18n="project_payout.step_2_content.propose_payout">Propose Payout</button>
              </div>
            </div>
            
            <!-- Test button to show manual form -->
            <div class="form-group" style="margin-top: 1rem; text-align: center;">
              <button id="test-show-form" class="btn btn-info btn-xs">Test: Show Manual Form</button>
            </div>
            
            <!-- Manual Transaction ID Input Form (shown after proposal) -->
            <div id="manual-tx-form" class="form-group" style="margin-top: 1rem; padding: 1rem; border: 1px solid var(--border-color); border-radius: 0.375rem; background: var(--bg-secondary); display: none;">
              <h4 style="margin-bottom: 0.5rem; color: var(--text-secondary);">Manual Transaction ID Input</h4>
              <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">If the transaction ID was not automatically detected, you can enter it manually:</p>
              <div class="form-row">
                <div class="form-group" style="flex: 1;">
                  <label for="manual-tx-id-step2" style="font-size: 0.9rem;">Transaction ID:</label>
                  <input type="text" id="manual-tx-id-step2" class="form-control" placeholder="Enter transaction ID (e.g., 1, 2, 3...)" style="font-size: 0.9rem;">
                </div>
                <div class="form-group" style="display: flex; align-items: end;">
                  <button id="set-manual-tx-id-step2" class="btn btn-info" style="font-size: 0.9rem;">Set Transaction ID</button>
                </div>
              </div>
              <div class="form-row" style="margin-top: 1rem;">
                <div class="form-group" style="text-align: right;">
                  <button id="continue-to-step3" class="btn btn-success" style="font-size: 0.9rem;">Continue to Step 3</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 3: Confirm Transaction -->
        <div class="card hidden" id="step-3-content">
          <div class="card-header">
            <h2 class="card-title" data-i18n="project_payout.step_3_content.title"><i class="fas fa-check-circle"></i> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h2>
          </div>
          <div class="card-body">
            <div class="alert alert-info">
              <strong data-i18n="project_payout.workflow_steps.step_3">Step 3:</strong> <span data-i18n="project_payout.step_3_content.info_step_3">The transaction needs to be confirmed by multiple signers. Each authorized signer must confirm the transaction.</span>
            </div>
            
            <div id="transaction-details">
              <h3 data-i18n="project_payout.step_3_content.transaction">Transaction: <span id="tx-id-display"></span></h3>
              <div class="transaction-details" id="tx-details-display"></div>
            </div>
            
            <div class="form-group">
              <button id="refresh-tx-button" class="btn btn-secondary" data-i18n="project_payout.step_3_content.refresh_status">Refresh Transaction Status</button>
              <button id="confirm-button" class="btn btn-primary" data-i18n="project_payout.step_3_content.confirm_transaction">Confirm Transaction</button>
              <button id="skip-to-next" class="btn btn-warning" style="margin-left: 0.5rem;">Skip to Next Step</button>
            </div>
            
            <!-- Manual Transaction ID Input Form -->
            <div class="form-group" style="margin-top: 1rem; padding: 1rem; border: 1px solid var(--border-color); border-radius: 0.375rem; background: var(--bg-secondary);">
              <h4 style="margin-bottom: 0.5rem; color: var(--text-secondary);">Manual Transaction ID Input</h4>
              <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">If the transaction ID was not automatically detected, you can enter it manually:</p>
              <div class="form-row">
                <div class="form-group" style="flex: 1;">
                  <label for="manual-tx-id" style="font-size: 0.9rem;">Transaction ID:</label>
                  <input type="text" id="manual-tx-id" class="form-control" placeholder="Enter transaction ID (e.g., 1, 2, 3...)" style="font-size: 0.9rem;">
                </div>
                <div class="form-group" style="display: flex; align-items: end;">
                  <button id="set-manual-tx-id" class="btn btn-info" style="font-size: 0.9rem;">Set Transaction ID</button>
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <button id="back-step-3" class="btn btn-secondary" data-i18n="project_payout.step_3_content.back">Back</button>
              </div>
              <div class="form-group" style="text-align: right;">
                <button id="next-step-3" class="btn btn-primary" disabled data-i18n="project_payout.step_3_content.next_step">Next: Execute Transaction</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 4: Execute Transaction -->
        <div class="card hidden" id="step-4-content">
          <div class="card-header">
            <h2 class="card-title" data-i18n="project_payout.step_4_content.title"><i class="fas fa-play-circle"></i> –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h2>
          </div>
          <div class="card-body">
            <div class="alert alert-info">
              <strong data-i18n="project_payout.workflow_steps.step_4">Step 4:</strong> <span data-i18n="project_payout.step_4_content.info_step_4">Once the required number of confirmations has been received, the transaction can be executed.</span>
            </div>
            
            <div id="execution-details">
              <h3 data-i18n="project_payout.step_4_content.transaction">Transaction: <span id="execute-tx-id-display"></span></h3>
              <div class="transaction-details" id="execute-tx-details-display"></div>
              <div class="form-group">
                <div class="alert alert-warning">
                  <strong data-i18n="project_payout.step_4_content.warning">Warning:</strong> <span data-i18n="project_payout.step_4_content.warning_text">This will transfer funds from the treasury to the specified recipient.</span>
                </div>
              </div>
            </div>
            
            <div class="form-group">
              <button id="refresh-exec-tx-button" class="btn btn-secondary" data-i18n="project_payout.step_4_content.refresh_status">Refresh Transaction Status</button>
              <button id="execute-button" class="btn btn-warning" data-i18n="project_payout.step_4_content.execute_transaction">Execute Transaction</button>
              <button id="skip-to-next-step4" class="btn btn-info" style="margin-left: 0.5rem;">Skip to Next Step</button>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <button id="back-step-4" class="btn btn-secondary" data-i18n="project_payout.step_4_content.back">Back</button>
              </div>
              <div class="form-group" style="text-align: right;">
                <button id="next-step-4" class="btn btn-primary" disabled data-i18n="project_payout.step_4_content.next_step">Next: Complete Project</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 5: Complete Project -->
        <div class="card hidden" id="step-5-content">
          <div class="card-header">
            <h2 class="card-title" data-i18n="project_payout.step_5_content.title"><i class="fas fa-flag-checkered"></i> –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</h2>
          </div>
          <div class="card-body">
            <div class="alert alert-info">
              <strong data-i18n="project_payout.workflow_steps.step_5">Step 5:</strong> <span data-i18n="project_payout.step_5_content.info_step_5">Mark the project as completed by updating its status to "Paid".</span>
            </div>
            
            <div id="completion-details">
              <h3 data-i18n="project_payout.step_5_content.project">Project: <span id="complete-project-name-display"></span></h3>
              <div class="project-details" id="complete-project-details-display"></div>
            </div>
            
            <div class="form-group">
              <label for="completion-reason" data-i18n="project_payout.step_5_content.completion_notes">Completion Notes</label>
              <textarea id="completion-reason" class="form-control" rows="3" placeholder="Add notes about project completion" data-i18n-placeholder="project_payout.step_5_content.completion_notes_placeholder"></textarea>
            </div>
            
            <div class="form-group">
              <button id="refresh-project-status" class="btn btn-secondary" data-i18n="project_payout.step_5_content.refresh_status">Refresh Project Status</button>
              <button id="complete-project-button" class="btn btn-success" data-i18n="project_payout.step_5_content.mark_paid">Mark Project as Paid</button>
              <button id="skip-to-next-step5" class="btn btn-info" style="margin-left: 0.5rem;">Skip to Next Step</button>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <button id="back-step-5" class="btn btn-secondary" data-i18n="project_payout.step_5_content.back">Back</button>
              </div>
              <div class="form-group" style="text-align: right;">
                <button id="finish-workflow" class="btn btn-primary" disabled data-i18n="project_payout.step_5_content.finish">Finish Workflow</button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </main>

  <!-- Modal –¥–ª—è Check State -->
  <div id="modal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="modal-title">–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</h3>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body" id="modal-body">
        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
  <script src="./js/i18n.js"></script>
  <script src="./project-payout.js"></script>
  <script>
    // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    function closeModal() {
      if (window.projectPayout) {
        window.projectPayout.closeModal();
      }
    }
  </script>
</body>
</html>